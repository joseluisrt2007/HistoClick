<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Virreinato-Antecedentes</title>

  <!-- Fuente Poppins -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@700&display=swap" rel="stylesheet" />

  <link rel="stylesheet" href="carrucel.css" />
</head>
<body>
  <header>
    <button class="back-button" onclick="goBack()" aria-label="Regresar">‚üµ</button>
    <div class="header-title">El virreinato de la Nueva Espa√±a</div>
    <button class="game-button" onclick="window.location.href='juego-virreinato.html'" aria-label="Jugar Exploradores del Virreinato">üéÆ</button>
  </header>

  <div class="carousel">
    <button class="btn btn-left" aria-label="Anterior">&lt;</button>
    <div class="cards" id="cards">
      <div class="card"><img class="full" src="imagenes/virreinato.jpg" /><audio src="audios/virreinato.mp3"></audio></div>
      <div class="card"><h2>Fundaci√≥n y establecimiento</h2>
        <p>El Virreinato de la Nueva Espa√±a fue creado en 1535 tras la conquista de Tenochtitlan, para administrar los vastos territorios coloniales que Espa√±a pose√≠a en Am√©rica del Norte y partes de Asia.</p><audio src="audios/virreinato-a1.mp3"></audio></div>
      <div class="card"><h2>Gobierno virreinal</h2>
        <p>El virrey, representante directo del rey de Espa√±a, ten√≠a amplios poderes para gobernar, administrar justicia y defender el territorio frente a amenazas internas y externas.</p><audio src="audios/virreinato-a2.mp3"></audio></div>
      <div class="card"><h2>Econom√≠a basada en la miner√≠a y agricultura</h2>
        <p>La principal fuente de riqueza fue la miner√≠a de plata, especialmente en regiones como Zacatecas y Guanajuato, complementada por la agricultura que abastec√≠a a la poblaci√≥n local y exportaba productos.</p><audio src="audios/virreinato-a3.mp3"></audio></div>
      <div class="card"><h2>Sistema de encomiendas y trabajo ind√≠gena</h2>
        <p>Mediante las encomiendas, los espa√±oles recib√≠an el derecho a recibir tributo y trabajo ind√≠gena, lo que origin√≥ abusos y explotaci√≥n pero tambi√©n un complejo sistema social.</p><audio src="audios/virreinato-a4.mp3"></audio></div>
      <div class="card"><h2>Religi√≥n y evangelizaci√≥n</h2>
        <p>Los misioneros, principalmente franciscanos, dominicos y jesuitas, jugaron un papel vital en convertir a los pueblos ind√≠genas al catolicismo, fundando escuelas, hospitales y misiones.</p><audio src="audios/virreinato-a5.mp3"></audio></div>
      <div class="card"><h2>Sociedad jer√°rquica y mestizaje</h2>
        <p>La sociedad se dividi√≥ en castas, con espa√±oles peninsulares en la cima, criollos (espa√±oles nacidos en Am√©rica), mestizos y otros grupos, generando una mezcla cultural y racial √∫nica.</p><audio src="audios/virreinato-a6.mp3"></audio></div>
      <div class="card"><h2>Importancia de la ciudad de M√©xico-Tenochtitlan</h2>
        <p>Ciudad de M√©xico, construida sobre las ruinas de Tenochtitlan, fue la capital pol√≠tica y econ√≥mica, con importantes edificios como el Palacio Virreinal y la Catedral Metropolitana.</p><audio src="audios/virreinato-a7.mp3"></audio></div>
      <div class="card"><h2>Red de comercio y puertos</h2>
        <p>La Nueva Espa√±a fue un punto clave en la ruta comercial entre Espa√±a, Am√©rica y Asia, con puertos como Veracruz y Acapulco, que facilitaban la llegada de productos, personas e ideas.</p><audio src="audios/virreinato-a8.mp3"></audio></div>
      <div class="card"><h2>Impacto cultural y cient√≠fico</h2>
        <p>Se desarrollaron importantes instituciones educativas y culturales, como la Universidad de M√©xico, y se foment√≥ la ciencia y el arte, dejando un legado valioso en la historia colonial.</p><audio src="audios/virreinato-a9.mp3"></audio></div>
    </div>
    <button class="btn btn-right" aria-label="Siguiente">&gt;</button>
  </div>

  <script>
    const cards = [...document.querySelectorAll('.card')];
    const btnLeft = document.querySelector('.btn-left');
    const btnRight = document.querySelector('.btn-right');
    let current = 0;
    let currentAudio = null;

    function updatePositions() {
      const total = cards.length;
      cards.forEach((card, i) => {
        card.classList.remove('left', 'center', 'right', 'hidden');
        let pos = (i - current + total) % total;
        if (pos === 0) {
          card.classList.add('center');
        } else if (pos === 1) {
          card.classList.add('right');
        } else if (pos === total - 1) {
          card.classList.add('left');
        } else {
          card.classList.add('hidden');
        }
      });
    }

    function playAudioForCenterCard() {
      if (currentAudio) {
        currentAudio.pause();
        currentAudio.currentTime = 0;
      }

      const centerCard = document.querySelector('.card.center');
      const audio = centerCard.querySelector('audio');
      if (audio) {
        currentAudio = audio;
        audio.play().catch(e => console.log("Reproducci√≥n bloqueada hasta que el usuario interact√∫e"));
      }
    }

    function updatePositionsWithAudio() {
      updatePositions();
      playAudioForCenterCard();
    }

    btnLeft.addEventListener('click', () => {
      current = (current - 1 + cards.length) % cards.length;
      updatePositionsWithAudio();
    });

    btnRight.addEventListener('click', () => {
      current = (current + 1) % cards.length;
      updatePositionsWithAudio();
    });

    updatePositionsWithAudio();

    let startX = 0;
    let endX = 0;

    const carousel = document.querySelector('.carousel');

    carousel.addEventListener('touchstart', (e) => {
      startX = e.touches[0].clientX;
    }, false);

    carousel.addEventListener('touchend', (e) => {
      endX = e.changedTouches[0].clientX;
      handleGesture();
    }, false);

    function handleGesture() {
      const diffX = endX - startX;
      if (Math.abs(diffX) > 50) {
        if (diffX > 0) {
          current = (current - 1 + cards.length) % cards.length;
        } else {
          current = (current + 1) % cards.length;
        }
        updatePositionsWithAudio();
      }
    }

    // Funci√≥n para manejar el regreso
    function goBack() {
      if (window.history.length > 1) {
        history.back();
      } else {
        window.location.href = 'index.html'; // P√°gina por defecto si no hay historial
      }
    }
  </script>
</body>
</html>